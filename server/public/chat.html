<!DOCTYPE html>
<html lang="en">

<head>
    <title></title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="module" defer>
        const outEl = document.getElementById("out")
        const json = await(await fetch("/api/my/keys")).json()

        console.log(json)

        function base64ToBuf(strin) {
            const binaryString = atob(string)
            const length = binaryString.length;
            const bytes = new Uint8Array(length);

            for (let i = 0; i < length; i++) {
                bytes[i] = binaryString.charCodeAt(i);
            }

            return bytes.buffer;
        }

        async function importPubKey(buf) {
        }

        async function importPrivKey(buf, salt, pass) {
        }
    </script>
    <script type="module">
        const url = new URL(window.location.href)
        url.pathname = "/api/chat"
        url.protocol = "ws"

        const socket = new WebSocket(url.href)

        socket.addEventListener("open", (event) => {
            socket.send(JSON.stringify({
                Type: "config",
                Data: {
                    Config: "test config"
                }
            }));
            socket.send(JSON.stringify({
                Type: "message",
                Data: {
                    ChatUUID: "2c43007e-cec2-4cc7-bc45-3860264e7480", // change me
                    Text: "test",
                    MsgType: "text",
                    Encrypted: false
                }
            }));
        });
    </script>
</head>

<body>
    <output id="out"></output>

</body>

</html>
